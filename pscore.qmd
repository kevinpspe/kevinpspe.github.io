# Propensity Score Matching {.unnumbered}

<br />

Propensity Score Matching matches an individual that is treated (like Mia) with one that is not treated based on how similar their likelihoods of treatment are.

What is a likelihood of treatment? Well we know confounders cause people to get the treatment or not treatment. Thus, using an individual's confounder values, we can estimate their likelihood of getting treatment, called a propensity score.

$$
\text{propensity score } \pi =Pr(\text{you get treated}) 
$$

Then, we match units based on how close they are in propensity scores.

::: {.callout-note appearance="minimal"}
<div>

**Kevin's Estimator Score**: <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i> (2/5)

-   Propensity score matching performs worse than genetic matching.
-   Propensity score matching is much quicker and easier to estimate than genetic matching, so for large datasets, it is useful.
-   You should not use propensity score matching on small datasets, as it can be badly biased.
-   There are also some criticisms of propensity score outlined [here](https://gking.harvard.edu/publications/why-propensity-scores-should-not-be-used-formatching).

</div>
:::

<br />

To implement propensity score matching, we will need the **Matching** package.

```{r, eval = FALSE}
library(Matching)
```

First, we need to estimate the propensity scores with a logistic regression:

```{r, eval = FALSE}
propensity <- glm(D ~ X1 + X2,
                  data = my_data,
                  family = "binomial")
my_data$pscore <- predict(propensity,
                          type = "response")
```

::: aside
A random forest model is also possible, but less common.
:::

Now, we can implement the matching as follows.

```{r, eval = FALSE}
att <- Match(Y = my_data$Y,
             Tr = my_data$D,
             X = my_data[,"pscore"],
             M = 1,
             BiasAdjust = TRUE,
             Weight = 2)
summary(att)
```

::: aside
Replace **Y** with the outcome variable, **D** with the treatment variable.
:::

Our output estimate will be the ATT.
