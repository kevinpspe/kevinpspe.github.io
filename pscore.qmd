# Propensity Score Matching {.unnumbered}

<br />

Propensity Score Matching matches an individual that is treated (like Mia) with one that is not treated based on how similar their likelihoods of treatment are.

What is a likelihood of treatment? Well we know confounders cause people to get the treatment or not treatment. Thus, using an individual's confounder values, we can estimate their likelihood of getting treatment, called a propensity score.

$$
\text{propensity score } \pi =Pr(\text{you get treated}) 
$$

The conventional way of estimating the propensity score (likelihood of getting treated) is to use a logistic regression model, with your treatment status as the dependent variable, and your confounder values as the independent variables.

However, this means that propensity score matching is vulnerable to how good our logistic regression model used to estimate propensity scores are.

-   This is one of the reasons that genetic matching is now the preferred method for matching - and propensity score matching is used more as a backup.

::: aside
There are also some criticisms of propensity score outlined [here](https://gking.harvard.edu/publications/why-propensity-scores-should-not-be-used-formatching).
:::

<br />

To implement propensity score matching, we will need the **Matching** package.

```{r, eval = FALSE}
library(Matching)
```

First, we need to estimate the propensity scores with a logistic regression:

```{r, eval = FALSE}
propensity <- glm(D ~ X1 + X2,
                  data = my_data,
                  family = "binomial")
my_data$pscore <- predict(propensity,
                          type = "response")
```

::: aside
A random forest model is also possible, but less common.
:::

Now, we can implement the matching as follows.

```{r, eval = FALSE}
att <- Match(Y = my_data$Y,
             Tr = my_data$D,
             X = my_data[,"pscore"],
             M = 1,
             BiasAdjust = TRUE,
             Weight = 2)
summary(att)
```

::: aside
Replace **Y** with the outcome variable, **D** with the treatment variable.
:::

Our output estimate will be the ATT.
