# Fully Interacted Estimator

::: small
See [here](soo.qmd) on how selection on observables works, and the other estimators available.
:::

Regression is a natural way to control for confounders in selection on observables:

$$
Y_i = \alpha + D_i\tau + \b X_i' \b\beta + \eps_i
$$

::: small
Where $\alpha$ is the intercept and $\b X_i$ is a vector of confounder values for individual $i$.
:::

The ordinary least squares (OLS) estimate $\hat\tau$ will be an good estimator of the ATE if we account for all confounders (conditional ignorability) in vector $\b X_i$, and **there is no treatment heterogeneity**.

::: small
Heterogeneity means not all individuals have the same treatment effect. With heterogeneity, OLS is an estimator for an unhelpful combination of the ATT and ATU, not the ATE (Słoczyński, 2022).
:::

Heterogeneity is present in almost all situations we will need causal inference. [Lin (2013)](https://projecteuclid.org/journals/annals-of-applied-statistics/volume-7/issue-1/Agnostic-notes-on-regression-adjustments-to-experimental-data--Reexamining/10.1214/12-AOAS583.full) proposes the **fully interacted estimator**, which allows for consistent estimation of the ATE even with heterogeneity:

$$
Y_i = \alpha + D_i \tau + (\b{X}_i - \mean{\b X})' \b\beta \ + D_i (\b X_i - \mean{\b X})' \b\gamma \  + \eps_i
$$

::: small
$\mean{\b X}$ is a vector of the means of each confounder. $\tau$ is the estimate of the ATE. See [Lin (2013)](https://projecteuclid.org/journals/annals-of-applied-statistics/volume-7/issue-1/Agnostic-notes-on-regression-adjustments-to-experimental-data--Reexamining/10.1214/12-AOAS583.full) for proofs.
:::

::: {.callout-note appearance="minimal"}
<div>

**Kevin's Estimator Score**: <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i> (3/5)

-   Fully interacted estimator is decent at estimating the ATE, especially in large samples. We should be more careful in smaller samples.
-   Big concern: the fully interacted estimator still **assumes a linear relationship between confounders and the outcome**. The other estimators covered later are non-parametric (not model based), so if we have any reason to suspect non-linearity, we should not use this estimator.

</div>
:::

Before you implement the estimator, make sure you have reasons to believe you meet the neccessary assumptions for [selection on observables](soo.qmd).

We will need the **estimatr** package:

```{r, eval = FALSE}
library(estimatr)
```

Then, we can use the **lm_lin()** function to estimate:

```{r, eval = FALSE}
ate <- estimatr::lm_lin(Y ~ D,
                        covariates = ~ X1 + X2 + X3,
                        data = my_data)
summary(ate)
```

The output will be the ATE - the average treatment effect for all units in the study.
